#!/usr/bin/env -S deno run --allow-write --allow-read

import { parse } from 'https://deno.land/std/flags/mod.ts';
import { ensureDir, ensureFile } from 'https://deno.land/std/fs/mod.ts';

const { day, part: passedInPart } = parse(Deno.args);
let part = passedInPart;

if (!day) {
  throw new Error('The --day argument is required.');
}

if (!part) {
  console.debug('No --part argument provided, defaulting to part 1.');
  part = 1;
}

const solutionFileContents = `
// This file is generated by the create-files script in ../utils.
// Day ${day} part ${part}
// https://adventofcode.com/2021/day/${day}${part === 2 ? '#part2' : ''}
// input: day${day}/input.txt

const d${day}p${part}Input = (await Deno.readTextFile('day${day}/input.txt')).split('\\n');
console.log(d${day}p${part}Input);`;

// create a directory for the day
await ensureDir(`./day${day}`);

// create the input file for the day
await ensureFile(`./day${day}/input.txt`);

// create the solution files for the day
await ensureFile(`./day${day}/part${part}.ts`);
await Deno.writeFile(
  `./day${day}/part${part}.ts`,
  new TextEncoder().encode(solutionFileContents)
);
